<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body { background: #f5f6fa; }
        .card { border-radius: 12px; box-shadow: 0 10px 20px rgba(0,0,0,.08); }
    </style>
</head>

<body>

<div class="container mt-4">

    <!-- âŒ NOT AUTHENTICATED -->
    <div sec:authorize="!isAuthenticated()" class="alert alert-warning text-center">
        You are not authenticated. Please <a href="/login">log in</a> to continue.
    </div>

    <!-- âœ… AUTHENTICATED -->
    <div sec:authorize="isAuthenticated()">

        <!-- Welcome -->
        <div class="card mb-4">
            <div class="card-body">

                <h4>Welcome, <span th:text="${username}"></span></h4>
                <p>Your roles: <span th:text="${roles}"></span></p>
                <p th:if="${rememberMe}">
                    ğŸ” You are logged in using <strong>Remember Me</strong>.
                    Session expires in <span th:text="${expiresIn}"></span> seconds.
                </p>

            </div>
        </div>

        <!-- ================= ADMIN ONLY ================= -->
        <div sec:authorize="hasRole('ADMIN')" class="card mb-4 border-start border-4 border-danger">
            <div class="card-body">
                <h5>ğŸ‘‘ Admin Panel</h5>
                <p>System-wide administrative controls.</p>

                <a href="/admin/users" class="btn btn-danger btn-sm">Manage Users</a>
                <a href="/admin/settings" class="btn btn-outline-danger btn-sm">System Settings</a>
            </div>
        </div>

        <!-- ================= STAFF ONLY ================= -->
        <div sec:authorize="hasRole('STAFF')" class="card mb-4 border-start border-4 border-info">
            <div class="card-body">
                <h5>ğŸ§‘â€ğŸ’¼ Staff Tools</h5>
                <p>Operational and management tools.</p>

                <a href="/staff/tasks" class="btn btn-info btn-sm">View Tasks</a>
            </div>
        </div>

        <!-- ========== ADMIN OR STAFF ========== -->
        <div sec:authorize="hasAnyRole('ADMIN','STAFF')" class="card mb-4 border-start border-4 border-warning">
            <div class="card-body">
                <h5>ğŸ› ï¸ Management Section</h5>
                <p>Shared tools for Admin & Staff.</p>

                <a href="/reports" class="btn btn-warning btn-sm">Reports</a>
            </div>
        </div>

        <!-- ========== ADMIN AND STAFF (BOTH REQUIRED) ========== -->
        <div sec:authorize="hasRole('ADMIN') and hasRole('STAFF')"
             class="card mb-4 border-start border-4 border-success">
            <div class="card-body">
                <h5>ğŸ” Dual-Role Access</h5>
                <p>You have both ADMIN and STAFF privileges.</p>
            </div>
        </div>

        <!-- ================= USER (DEFAULT) ================= -->
        <div sec:authorize="hasRole('USER')" class="card mb-4">
            <div class="card-body">
                <h5>ğŸ‘¤ User Dashboard</h5>
                <p>Your personal activity & profile.</p>

                <a href="/profile/edit" class="btn btn-primary btn-sm">Edit Profile</a>
                <a href="/security/change-password" class="btn btn-outline-primary btn-sm">
                    Change Password
                </a>
            </div>
        </div>

        <!-- LOGOUT -->
        <div class="text-center">
            <form method="post" action="/logout">
                <button class="btn btn-secondary">Logout</button>
            </form>
        </div>

    </div>
</div>

</body>
</html>
